FROM python:3.11.6-slim

ENV PYTHONUNBUFFERED=1

WORKDIR /app
RUN mkdir /app/scheduler

# Copy requirements and install dependencies
COPY backend/scheduler/requirements.txt ./scheduler/requirements.txt

RUN pip install --upgrade pip && \
    pip install -r scheduler/requirements.txt

COPY backend/core ./core
RUN pip install -e ./core

# Copy the source code
COPY backend/indexer_blockchain ./indexer_blockchain
COPY backend/indexer_gifts ./indexer_gifts
COPY backend/indexer_price ./indexer_price
COPY backend/indexer_stickers ./indexer_stickers
COPY backend/scheduler ./scheduler
